<div class="min-h-screen bg-gradient-to-br from-indigo-50 via-white to-cyan-50 py-12 sm:px-6 lg:px-8">
  <div class="sm:mx-auto sm:w-full sm:max-w-3xl">
    <!-- Header Section -->
    <div class="text-center mb-12">
      <h2 class="text-4xl font-bold tracking-tight text-gray-900 mb-2">Create your account</h2>
      <p class="text-lg text-gray-600">
        Already have an account?
        <%= link_to "Sign in here", new_session_path(resource_name), class: "font-medium text-indigo-600 hover:text-indigo-500" %>
      </p>
    </div>

    <div class="bg-white shadow-xl rounded-2xl overflow-hidden">
      <%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { class: "space-y-8" }) do |f| %>
        <%= render "devise/shared/error_messages", resource: resource %>

        <!-- Progress Steps -->
        <div class="bg-gray-50 px-8 py-4 border-b border-gray-200">
          <div class="flex justify-between">
            <div class="flex items-center">
              <div class="flex items-center justify-center w-8 h-8 rounded-full bg-indigo-600 text-white font-semibold">1</div>
              <span class="ml-3 text-sm font-medium">Personal Info</span>
            </div>
            <div class="hidden sm:flex items-center">
              <div class="h-0.5 w-12 bg-gray-300"></div>
              <div class="flex items-center justify-center w-8 h-8 rounded-full bg-gray-200 text-gray-600 font-semibold">2</div>
              <span class="ml-3 text-sm font-medium text-gray-500">Address</span>
            </div>
            <div class="hidden sm:flex items-center">
              <div class="h-0.5 w-12 bg-gray-300"></div>
              <div class="flex items-center justify-center w-8 h-8 rounded-full bg-gray-200 text-gray-600 font-semibold">3</div>
              <span class="ml-3 text-sm font-medium text-gray-500">Account</span>
            </div>
          </div>
        </div>

        <div class="px-8 py-12 space-y-12">
          <!-- Personal Information Section -->
          <section>
            <div class="flex items-center mb-6">
              <h3 class="text-xl font-semibold text-gray-900">Personal Information</h3>
              <div class="flex-grow ml-4 border-t border-gray-200"></div>
            </div>
            <div class="grid grid-cols-1 gap-6 sm:grid-cols-2">
              <div>
                <%= f.label :first_name, class: "block text-base font-medium text-gray-700 mb-2" %>
                <%= f.text_field :first_name, class: "block w-full rounded-xl border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-base py-3 px-4" %>
              </div>

              <div>
                <%= f.label :last_name, class: "block text-base font-medium text-gray-700 mb-2" %>
                <%= f.text_field :last_name, class: "block w-full rounded-xl border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-base py-3 px-4" %>
              </div>

              <div>
                <%= f.label :ic_number, "IC Number", class: "block text-base font-medium text-gray-700 mb-2" %>
                <%= f.text_field :ic_number, class: "block w-full rounded-xl border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-base py-3 px-4" %>
              </div>

              <div>
                <%= f.label :phone_number, class: "block text-base font-medium text-gray-700 mb-2" %>
                <%= f.telephone_field :phone_number, class: "block w-full rounded-xl border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-base py-3 px-4" %>
              </div>
            </div>
          </section>

          <!-- Registration Type Section -->
          <section>
            <div class="flex items-center mb-6">
              <h3 class="text-xl font-semibold text-gray-900">Registration Type</h3>
              <div class="flex-grow ml-4 border-t border-gray-200"></div>
            </div>
            <div class="bg-indigo-50 rounded-xl p-6 border border-indigo-100" data-controller="registration-type">
              <fieldset>
                <legend class="block text-base font-medium text-gray-700 mb-4">Select your registration type:</legend>
                <div class="flex items-center gap-8">
                  <div class="flex items-center">
                    <%= f.radio_button :seafarer, true, 
                        id: "registration_type_seafarer",
                        class: "h-5 w-5 border-gray-300 text-indigo-600 focus:ring-indigo-500",
                        data: { 
                          registration_type_target: "seafarerRadio",
                          action: "click->registration-type#toggle"
                        } %>
                    <%= f.label :seafarer_true, "Seafarer", for: "registration_type_seafarer", class: "ml-3 block text-base text-gray-700" %>
                  </div>
                  <div class="flex items-center">
                    <%= f.radio_button :seafarer, false, 
                        id: "registration_type_agent",
                        class: "h-5 w-5 border-gray-300 text-indigo-600 focus:ring-indigo-500",
                        data: { 
                          registration_type_target: "agentRadio",
                          action: "click->registration-type#toggle"
                        } %>
                    <%= f.label :seafarer_false, "Agent", for: "registration_type_agent", class: "ml-3 block text-base text-gray-700" %>
                  </div>
                </div>
              </fieldset>

              <!-- Seafarer Fields -->
              <div class="mt-6 space-y-6" data-registration-type-target="seafarerFields">
                <div>
                  <%= f.label :seafarer_id, "Seafarer ID", class: "block text-base font-medium text-gray-700 mb-2" %>
                  <%= f.text_field :seafarer_id, 
                      id: "seafarer_id",
                      class: "block w-full rounded-xl border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-base py-3 px-4" %>
                </div>
                <div>
                  <%= f.label :seafarer_expiry, "Seafarer ID Expiry Date", class: "block text-base font-medium text-gray-700 mb-2" %>
                  <%= f.date_field :seafarer_expiry, 
                      id: "seafarer_expiry",
                      class: "block w-full rounded-xl border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-base py-3 px-4" %>
                </div>
              </div>

              <!-- Agent Fields -->
              <div class="mt-6 space-y-6 hidden" data-registration-type-target="agentFields">
                <div>
                  <%= f.label :company_name, "Company Name", class: "block text-base font-medium text-gray-700 mb-2" %>
                  <%= f.text_field :company_name, 
                      id: "company_name",
                      class: "block w-full rounded-xl border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-base py-3 px-4" %>
                </div>
                <div>
                  <%= f.label :company_registration_number, "Company Registration Number", class: "block text-base font-medium text-gray-700 mb-2" %>
                  <%= f.text_field :company_registration_number, 
                      id: "company_registration_number",
                      class: "block w-full rounded-xl border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-base py-3 px-4" %>
                </div>
                <div>
                  <%= f.label :business_license, "Business License Number", class: "block text-base font-medium text-gray-700 mb-2" %>
                  <%= f.text_field :business_license, 
                      id: "business_license",
                      class: "block w-full rounded-xl border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-base py-3 px-4" %>
                </div>
              </div>
            </div>
          </section>

          <!-- Address Information Section -->
          <section>
            <div class="flex items-center mb-6">
              <h3 class="text-xl font-semibold text-gray-900">Address Information</h3>
              <div class="flex-grow ml-4 border-t border-gray-200"></div>
            </div>
            <div class="space-y-6">
              <div>
                <%= f.label :street, "Street Address", class: "block text-base font-medium text-gray-700 mb-2" %>
                <%= f.text_field :street, class: "block w-full rounded-xl border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-base py-3 px-4" %>
              </div>

              <div class="grid grid-cols-1 gap-6 sm:grid-cols-2">
                <div>
                  <%= f.label :postcode, class: "block text-base font-medium text-gray-700 mb-2" %>
                  <%= f.text_field :postcode, class: "block w-full rounded-xl border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-base py-3 px-4" %>
                </div>

                <div>
                  <%= f.label :state, class: "block text-base font-medium text-gray-700 mb-2" %>
                  <%= f.select :state, 
                      ["Johor", "Kedah", "Kelantan", "Melaka", "Negeri Sembilan", "Pahang", "Perak", "Perlis", "Pulau Pinang", "Sabah", "Sarawak", "Selangor", "Terengganu", "Kuala Lumpur", "Labuan", "Putrajaya"],
                      { include_blank: "Select state" },
                      class: "block w-full rounded-xl border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-base py-3 px-4" %>
                </div>

                <div class="sm:col-span-2">
                  <%= f.label :country, class: "block text-base font-medium text-gray-700 mb-2" %>
                  <%= f.text_field :country, value: "Malaysia", class: "block w-full rounded-xl border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-base py-3 px-4" %>
                </div>
              </div>
            </div>
          </section>

          <!-- Account Information Section -->
          <section>
            <div class="flex items-center mb-6">
              <h3 class="text-xl font-semibold text-gray-900">Account Credentials</h3>
              <div class="flex-grow ml-4 border-t border-gray-200"></div>
            </div>
            <div class="space-y-6">
              <div>
                <%= f.label :email, class: "block text-base font-medium text-gray-700 mb-2" %>
                <%= f.email_field :email, autocomplete: "email", class: "block w-full rounded-xl border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-base py-3 px-4" %>
              </div>

              <div>
                <%= f.label :password, class: "block text-base font-medium text-gray-700 mb-2" %>
                <%= f.password_field :password, autocomplete: "new-password", class: "block w-full rounded-xl border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-base py-3 px-4" %>
                <p class="mt-2 text-sm text-gray-500">Minimum 6 characters</p>
              </div>

              <div>
                <%= f.label :password_confirmation, class: "block text-base font-medium text-gray-700 mb-2" %>
                <%= f.password_field :password_confirmation, autocomplete: "new-password", class: "block w-full rounded-xl border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-base py-3 px-4" %>
              </div>
            </div>
          </section>

          <!-- Terms and Conditions -->
          <section class="border-t border-gray-200 pt-8">
            <div class="bg-gray-50 rounded-xl p-6">
              <div class="flex items-start">
                <div class="flex h-5 items-center">
                  <input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500" required>
                </div>
                <div class="ml-3">
                  <p class="text-base text-gray-700">
                    By creating an account, you agree to our
                    <%= link_to "Terms of Service", "#", class: "font-medium text-indigo-600 hover:text-indigo-500" %> and
                    <%= link_to "Privacy Policy", "#", class: "font-medium text-indigo-600 hover:text-indigo-500" %>.
                  </p>
                </div>
              </div>
            </div>
          </section>

          <!-- Submit Button -->
          <div class="pt-6">
            <%= f.submit "Create Account", class: "w-full flex justify-center py-4 px-4 border border-transparent rounded-xl shadow-sm text-base font-medium text-white bg-gradient-to-r from-indigo-600 to-blue-600 hover:from-indigo-700 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-all duration-200" %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>

<% content_for :head do %>
  <script>
    // Stimulus controller for handling registration type toggle
    application.register("registration-type", class extends Stimulus.Controller {
      static targets = ["seafarerFields", "agentFields", "seafarerRadio", "agentRadio"]

      connect() {
        // Set initial state based on saved value or default to seafarer
        this.toggle()
      }

      toggle() {
        if (this.seafarerRadioTarget.checked) {
          this.seafarerFieldsTarget.classList.remove('hidden')
          this.agentFieldsTarget.classList.add('hidden')
        } else if (this.agentRadioTarget.checked) {
          this.seafarerFieldsTarget.classList.add('hidden')
          this.agentFieldsTarget.classList.remove('hidden')
        }
      }
    })
  </script>
<% end %> 